<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Operator Overlay</title>
  <link rel="stylesheet" href="./theme.css">
  <style>
    body {
      margin: 0;
      background: transparent;
      font-family: sans-serif;
      color: var(--text);
    }

    input,
    select,
    textarea {
      accent-color: var(--accent);
      background: var(--control-bg);
      color: var(--control-text);
      border: 1px solid var(--control-border);
    }

    input:focus-visible,
    select:focus-visible,
    textarea:focus-visible,
    button:focus-visible {
      outline: 2px solid var(--focus-ring);
      outline-offset: 2px;
    }

    .overlay {
      position: fixed;
      inset: 0;
      display: none;
      align-items: center;
      justify-content: center;
      background: var(--overlay-bg);
      z-index: 2000;
      padding: 20px;
      box-sizing: border-box;
    }

    .overlay.open {
      display: flex;
    }

    .modal {
      background: var(--modal-bg);
      border: 1px solid var(--border);
      border-radius: 12px;
      width: min(520px, 90vw);
      box-shadow: 0 10px 30px var(--modal-shadow);
    }

    .modalHeader {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      padding: 10px 12px;
      border-bottom: 1px solid var(--border);
      background: var(--modal-header-bg);
    }

    .modalBody {
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .row {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .modalFooter {
      display: flex;
      justify-content: flex-end;
      gap: 8px;
      padding: 10px 12px;
      border-top: 1px solid var(--border);
      background: var(--modal-footer-bg);
    }

    .small {
      font-size: 12px;
      color: var(--text-muted);
    }

    .wideModal {
      width: min(980px, 96vw);
    }

    .llmTable {
      display: grid;
      grid-template-columns: 120px 160px 1fr 1fr 40px;
      gap: 8px;
      align-items: center;
    }

    .llmTableHeader {
      font-size: 11px;
      color: var(--text-muted);
      font-weight: 600;
    }

    .llmTable input {
      width: 100%;
      padding: 6px 8px;
      box-sizing: border-box;
      font-size: 12px;
      border: 1px solid var(--border);
      background: var(--panel-bg);
      color: var(--text);
    }

    .llmTable button {
      padding: 4px 6px;
      font-size: 12px;
    }

    button {
      border: 1px solid var(--border);
      background: var(--panel-bg-alt);
      color: var(--text);
      border-radius: 6px;
    }

    button.primary {
      background: var(--accent);
      color: var(--button-primary-text);
      border-color: var(--accent);
    }

    .appearanceList {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .appearanceItem {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px 10px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      background: var(--panel-bg);
      cursor: pointer;
    }

    .appearanceItem.selected {
      border-color: var(--accent);
      box-shadow: 0 0 0 2px var(--focus-ring);
    }

    .appearanceActions {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .appearanceMeta {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .appearanceLabel {
      font-size: 13px;
      font-weight: 600;
    }

    .appearanceRow {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1 1 auto;
      min-width: 0;
    }

    .appearanceEditor {
      margin-top: 12px;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 10px;
      background: var(--panel-bg);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .appearanceGrid {
      display: grid;
      gap: 8px;
    }

    .appearanceSwatchGrid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 6px 8px;
      max-height: min(40vh, 320px);
      overflow-y: auto;
      padding-right: 4px;
    }

    .appearanceSwatchRow {
      display: grid;
      grid-template-columns: 1fr auto;
      align-items: center;
      gap: 6px;
      padding: 4px 6px;
      border: 1px solid var(--border);
      border-radius: 6px;
      background: var(--panel-bg-alt);
    }

    .appearanceSwatchInput {
      width: 30px;
      height: 20px;
      padding: 0;
      border: 1px solid var(--border);
      border-radius: 4px;
      background: var(--panel-bg);
      cursor: pointer;
      font-size: 0;
    }

    .appearanceSwatchControls {
      display: flex;
      align-items: center;
      justify-content: flex-end;
      gap: 6px;
    }

    .appearanceAlphaToggle {
      width: 30px;
      height: 20px;
      border: 1px solid var(--border);
      border-radius: 4px;
      background: var(--panel-bg);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: var(--text-muted);
      font-size: 12px;
      font-weight: 600;
      padding: 0;
    }

    .appearanceAlphaToggle svg {
      display: none;
    }

    .appearanceSwatchAlpha {
      display: none;
    }

    .alphaPopup {
      position: fixed;
      background: transparent;
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px;
      box-shadow: 0 8px 18px var(--modal-shadow);
      z-index: 3000;
      display: none;
      flex-direction: column;
      align-items: center;
      gap: 6px;
    }

    .menuLayer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 2500;
    }

    .menuLayer.active {
      pointer-events: auto;
    }

    .menuPopup {
      position: absolute;
      background: var(--panel-bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 6px;
      min-width: 220px;
      box-shadow: 0 8px 18px var(--modal-shadow);
      display: none;
      flex-direction: column;
      gap: 4px;
      pointer-events: auto;
    }

    .menuPopup.open {
      display: flex;
    }

    .menuEntry {
      padding: 6px 8px;
      border-radius: 6px;
      font-size: 12px;
      color: var(--text);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .menuEntry:hover {
      background: var(--panel-bg-alt);
    }

    .menuGroupLabel {
      font-size: 11px;
      color: var(--text-muted);
      padding: 4px 8px 0;
    }

    .menuSeparator {
      height: 1px;
      background: var(--border);
      margin: 4px 0;
    }

    .alphaPopup.open {
      display: inline-flex;
    }

    .alphaSlider {
      writing-mode: bt-lr;
      -webkit-appearance: slider-vertical;
      width: 24px;
      height: 120px;
    }

    .alphaValueInput {
      width: 60px;
      font-size: 12px;
    }

    .appearanceGrid input[type="text"] {
      width: 100%;
      padding: 6px 8px;
      box-sizing: border-box;
      font-size: 12px;
    }

    .appearancePreviewBox {
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 8px;
      background: var(--panel-bg-alt);
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 8px;
      max-height: min(40vh, 320px);
      overflow: auto;
    }

    .appearanceSplitHandle {
      height: 6px;
      border-radius: 999px;
      background: var(--border);
      cursor: ns-resize;
      margin: 6px 0;
      opacity: 0.8;
    }

    .appearancePreviewSidebar {
      background: var(--panel-bg);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 6px;
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .appearancePreviewButton {
      background: var(--accent);
      color: var(--button-primary-text);
      border: 1px solid var(--accent);
      padding: 4px 6px;
      border-radius: 6px;
      font-size: 11px;
      text-align: center;
    }

    .appearancePreviewCard {
      background: var(--panel-bg-alt);
      border: 1px solid var(--border);
      border-radius: 6px;
      padding: 4px 6px;
      font-size: 10px;
      color: var(--text);
    }

    .appearancePreviewMain {
      background: var(--app-bg);
      border: 1px dashed var(--border);
      border-radius: 6px;
      padding: 6px;
      display: flex;
      flex-direction: column;
      gap: 4px;
      color: var(--text);
    }
  </style>
</head>

<body>
  <div id="gettingStartedOverlay" class="overlay" aria-hidden="true">
    <div class="modal">
      <div class="modalHeader">
        <div>Getting started</div>
        <button id="gettingStartedClose">X</button>
      </div>
      <div class="modalBody">
        <div class="small">Choose workspace</div>
        <div class="small">Paste bootstrap prompt into the chat</div>
        <div class="small">Run the interface spec command and paste the result back</div>
        <div class="small">Review commands in the inbox and run them</div>
      </div>
      <div class="modalFooter">
        <button id="gettingStartedCloseFooter">Close</button>
      </div>
    </div>
  </div>
  <div id="llmProfilesOverlay" class="overlay" aria-hidden="true">
    <div class="modal wideModal">
      <div class="modalHeader">
        <div>LLM Profiles</div>
        <button id="llmClose">X</button>
      </div>
      <div class="modalBody">
        <div class="small" style="margin-bottom:8px;">Add or edit LLM start URLs and allowed hosts (comma separated).</div>
        <div class="llmTable llmTableHeader">
          <div>ID</div>
          <div>Label</div>
          <div>Start URL</div>
          <div>Allowed hosts</div>
          <div></div>
        </div>
        <div id="llmProfilesBody" class="llmTable" style="margin-top:6px;"></div>
        <div class="row" style="margin-top:10px;">
          <button id="llmAdd">Add profile</button>
        </div>
      </div>
      <div class="modalFooter">
        <button id="llmReset">Reset to defaults</button>
        <button id="llmCancel">Close</button>
        <button id="llmSave">Save</button>
      </div>
    </div>
  </div>
  <div id="appearanceOverlay" class="overlay" aria-hidden="true">
    <div class="modal wideModal">
      <div class="modalHeader">
        <div>Appearance</div>
        <button id="appearanceClose">X</button>
      </div>
      <div class="modalBody">
        <div class="small" style="margin-bottom:8px;">Choose a visual style for the Operator UI.</div>
        <div id="appearanceList" class="appearanceList"></div>
        <div class="row" style="justify-content:space-between; margin-top:10px;">
          <button id="appearanceAdd">Add appearance</button>
          <button id="appearanceRemove">Remove selected</button>
        </div>
      </div>
      <div class="modalFooter">
        <button id="appearanceReset">Reset to defaults</button>
        <button id="appearanceCancel">Cancel</button>
        <button id="appearanceSave">Save</button>
      </div>
    </div>
  </div>
  <div id="appearanceEditorOverlay" class="overlay" aria-hidden="true">
    <div class="modal wideModal">
      <div class="modalHeader">
        <div>Edit appearance</div>
        <button id="appearanceEditorClose">X</button>
      </div>
      <div class="modalBody">
        <div class="appearanceEditor">
          <div class="appearanceGrid">
            <div class="small">ID</div>
            <input id="appearanceId" type="text" />
            <div class="small">Label</div>
            <input id="appearanceLabel" type="text" />

            <div id="appearanceSwatchGrid" class="appearanceSwatchGrid"></div>
          </div>
        </div>
        <div id="appearanceSplitHandle" class="appearanceSplitHandle" aria-hidden="true"></div>
        <div class="appearancePreviewBox" id="appearanceEditorPreview">
          <div class="appearancePreviewSidebar">
            <div class="small">Panels</div>
            <div class="appearancePreviewButton">Primary Action</div>
            <div class="appearancePreviewCard">Secondary</div>
            <div class="appearancePreviewCard" style="color: var(--text-muted);">Muted text</div>
            <div class="appearancePreviewCard" style="background: var(--accent-muted); border-color: var(--accent);">Accent muted</div>
            <div class="appearancePreviewCard" style="background: var(--panel-bg-alt);">Panel alt</div>
            <div class="appearancePreviewCard" style="border-color: var(--border);">Border preview</div>
            <div class="appearancePreviewCard" style="outline: 2px solid var(--focus-ring);">Focus ring</div>
          </div>
          <div class="appearancePreviewMain">
            <div class="small">Status</div>
            <div class="appearancePreviewCard" style="color: var(--error);">Error text</div>
            <div class="appearancePreviewCard" style="color: var(--warning);">Warning text</div>
            <div class="appearancePreviewCard" style="background: var(--error-bg); border-color: var(--error-border); color: var(--error);">Error panel</div>
            <div class="appearancePreviewCard" style="background: var(--warning-bg);">Warning bg</div>
            <div class="appearancePreviewCard" style="background: var(--success-bg);">Success bg</div>
            <div class="appearancePreviewCard" style="background: var(--warning-accent); color: var(--text);">Warning accent</div>
            <div class="appearancePreviewCard" style="background: var(--success); color: var(--button-primary-text); border-color: var(--success-border);">Success accent</div>
            <div class="appearancePreviewCard" style="background: var(--danger); color: var(--button-primary-text);">Danger</div>
            <div class="appearancePreviewCard" style="background: var(--danger-active); color: var(--button-primary-text);">Danger active</div>
          </div>
          <div class="appearancePreviewMain">
            <div class="small">Controls</div>
            <div class="appearancePreviewCard">
              <input type="text" value="Control input" />
            </div>
            <div class="appearancePreviewCard" style="background: var(--modal-bg);">Modal bg</div>
            <div class="appearancePreviewCard" style="background: var(--modal-header-bg);">Modal header</div>
            <div class="appearancePreviewCard" style="background: var(--modal-footer-bg);">Modal footer</div>
            <div class="appearancePreviewCard" style="background: var(--overlay-bg);">Overlay bg</div>
            <div class="appearancePreviewCard" style="box-shadow: 0 10px 30px var(--modal-shadow);">Modal shadow</div>
            <div class="appearancePreviewCard" style="border-bottom: 2px solid var(--topbar-divider); box-shadow: 0 1px 0 var(--topbar-shadow);">Topbar divider</div>
            <div class="appearancePreviewCard" style="background: var(--toast-bg); color: var(--toast-text); border-color: var(--toast-bg);">Toast</div>
            <div class="appearancePreviewCard" style="background: var(--toast-error-bg); color: var(--toast-text); border-color: var(--toast-error-bg);">Toast error</div>
            <div class="appearancePreviewCard" style="box-shadow: 0 6px 18px var(--toast-shadow);">Toast shadow</div>
          </div>
        </div>
      </div>
      <div class="modalFooter">
        <button id="appearanceEditorCopy">Copy definition</button>
        <button id="appearanceEditorPaste">Paste definition</button>
        <button id="appearanceEditorCancel">Cancel</button>
        <button id="appearanceEditorSave">Save</button>
      </div>
    </div>
  </div>
  <div id="alphaPopup" class="alphaPopup" aria-hidden="true">
    <input id="alphaSlider" class="alphaSlider" type="range" min="0" max="100" step="1" />
    <input id="alphaValue" class="alphaValueInput" type="number" min="0" max="1" step="0.01" />
  </div>
  <div id="menuLayer" class="menuLayer" aria-hidden="true">
    <div class="menuPopup" id="menuWorkspace">
      <div class="menuEntry" id="menuSelectWorkspace">Select Workspace…</div>
      <div class="menuGroupLabel">Recent Workspaces</div>
      <div id="menuRecentList"></div>
      <div class="menuSeparator"></div>
      <div class="menuEntry" id="menuCloseWorkspace">Close Workspace</div>
    </div>
    <div class="menuPopup" id="menuSettings">
      <div class="menuEntry" id="menuLlmProfiles">LLM Profiles…</div>
      <div class="menuEntry" id="menuAppearance">Appearance…</div>
    </div>
    <div class="menuPopup" id="menuHelp">
      <div class="menuEntry" id="menuGettingStarted">Getting Started</div>
    </div>
  </div>
  <script src="./overlay.js"></script>
</body>

</html>
